<html>
  <%- include("../components/head.ejs") %>
  <body>
    <div class="uk-container uk-container-large"><%- include("../components/nav.ejs") %></div>
    <div
      class="uk-background-cover uk-background-muted uk-height-medium uk-width-large uk-flex uk-flex-center uk-flex-middle"
      style="
        background-image: url(../../public/imgs/callus.jpg);
        width: 100%;
        height: 400px;
        background-position: center;
        position: relative;
        z-index: -1;
      "
    >
      <div class="uk-overlay-default uk-position-cover" style="background: rgba(0, 0, 0, 0.3)"></div>
    </div>
    <div class="uk-container uk-container-large">
      <article class="uk-article uk-text-right" style="direction: rtl; margin-bottom: 10px">
        <div class="container-data-form">
          <h4 class="uk-text-primary uk-text-center">معلومات الاتصال</h4>
          <div>
            <span uk-icon="icon: home; ratio: 1"></span>
            <p>Office of Executive Management
              Operations in the Western region
              King,s Road Tower
              King Abdul Aziz Road,
              Level 26 | Jeddah, SA</p>
          </div>
          <div>
            <span uk-icon="icon: home; ratio: 1"></span>
            <p>Office of Executive Management
              Operations in the Eastern Region
              & Middle East, Asia
              and North Africa
              Khobar Gate Tower,
              King Fahd Road,
              Level 21 | Khobar, SA</p>
          </div>
          <div>
            <span uk-icon="icon: home; ratio: 1"></span>
            <p>Al Faisaliah Tower,
              King Fahd Road, Olaya District,
              Level 18 | Riyadh, SA</p>
          </div>
          <div>
            <span uk-icon="icon: home; ratio: 1"></span>
            <p>Head office :
              Family Way ®️ Global Group
              10 Avenue Kleber, 
              Ground floor - 6th floor,
              | Paris, France</p>
          </div>
          <div>
            <span uk-icon="icon: phone; ratio: 1"></span>
            <p>00966138080525</p>
          </div>
          <div>
            <span uk-icon="icon: phone; ratio: 1"></span>
            <p>00966539252225</p>
          </div>
          <div>
            <span uk-icon="icon: phone; ratio: 1"></span>
            <p>00966598455558</p>
          </div>
          <div>
            <span uk-icon="icon: social; ratio: 1"></span>
            <p>info@familyway.com.sa</p>
          </div>
          <div>
            <span uk-icon="icon: social; ratio: 1"></span>
            <p>info@familywaygroup.com</p>
          </div>
        </div>
        <hr class="uk-divider-icon" />
      </article>
      <article class="uk-article uk-text-right" style="direction: rtl; margin-top: 20px">
        <form class="uk-grid-small" uk-grid onsubmit="prev(event)">
          <div class="container-input uk-width-1-2@s uk-width-1-1@m">
            <label class="uk-form-label" for="form-stacked-text">الأسم</label>
            <input class="uk-input" type="text" placeholder="ادخل الأسم هنا" id="formName" />
          </div>
          <div class="container-input uk-width-1-2@s uk-width-1-1@m">
            <label class="uk-form-label" for="form-stacked-text">رقم الجوال</label>
            <input class="uk-input" type="text" placeholder="ادخل رقم الجوال هنا" id="formPhone" />
          </div>
          <div class="container-input uk-width-1-1@s">
            <label class="uk-form-label" for="form-stacked-text">البريد الألكتروني</label>
            <input class="uk-input" type="text" placeholder="ادخل البريد الألكتروني هنا" id="formEmail" />
          </div>
          <div class="container-input uk-width-1-1@s">
            <label class="uk-form-label" for="form-stacked-text">رسالتك</label>
            <textarea class="uk-textarea" rows="5" placeholder="ادخل نص الرساله هنا" id="formTextArea"></textarea>
          </div>
          <button
            class="uk-button uk-button-primary uk-width-1-1 uk-margin-small-bottom"
            onclick="sendMessageToAdmin()"
          >
            ارسال
          </button>
        </form>
      </article>
    </div>

    <%- include("../components/footer") %>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"></script>
    <script>
      const sendMessageToAdmin = async (e) => {
        // declare
        let name = document.getElementById('formName').value;
        let phone = document.getElementById('formPhone').value;
        let emailAddress = document.getElementById('formEmail').value;
        let message = document.getElementById('formTextArea').value;

        phone = ~~phone;

        console.log(name, phone, emailAddress, message);

        if (!name || !phone || !emailAddress || !message) {
          return UIkit.notification({ message: 'تأكد من ان البيانات كامله', status: 'danger' });
        }

        if (!Number.isInteger(phone)) {
          return UIkit.notification({ message: 'من فضلك ادخل ارقام جوال', status: 'danger' });
        }

        function ValidateEmail(mail) {
          if (/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(mail)) {
            return true;
          }
          return false;
        }

        if (!ValidateEmail(emailAddress)) {
          return UIkit.notification({ message: 'من فضلك ادخل بريد صحيح', status: 'danger' });
        }

        const returnForm = () => {
          document.querySelector('.uk-grid-small').reset();
        };

        try {
          const res = await axios.post('http://192.168.1.2:8080/api/user/mail', {
            name,
            phone,
            emailAddress,
            message
          });
          returnForm();
          return UIkit.notification({ message: 'تم ارسال رسالتك بنجاح', status: 'success' });
        } catch (e) {
          console.log(e);
          return UIkit.notification({ message: 'حدث خطأ ما', status: 'success' });
        }
      };

      const prev = (e) => {
        e.preventDefault();
        return false;
      };
    </script>
  </body>
  <%- include("../components/libs.ejs") %>
</html>
